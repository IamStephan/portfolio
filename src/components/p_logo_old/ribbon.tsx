import React from 'react'
import { spring } from 'react-flip-toolkit'

import LogoBase, { Props as BaseProps } from './_logo_base'

interface Props extends BaseProps {
  shouldExit?: boolean
}

const _handleExit = (element: HTMLElement) => {
  spring({
    values: {
      opacity: [1, 0],
      transform: [0, 25],
    },
    onUpdate({ opacity, transform }: any) {
      if (!element.getAttribute('moved')) {
        document.body.appendChild(element)
        element.setAttribute('moved', '')

        element.style.top = `${element.getAttribute('rect-top') as any}px`
        element.style.left = `${element.getAttribute('rect-left') as any}px`
        element.style.position = 'fixed'
      }

      element.style.opacity = opacity
      element.style.transform = `translateY(${transform}px)`
    },
    onComplete() {
      element.remove()
    },
  })
}

const Ribbon: React.FC<Props> = ({
  flipId = 'logo-ribbon',
  shouldExit,
  ...rest
}) => {
  return (
    <LogoBase
      flipId={flipId}
      divRef={(ref) => {
        if (ref) {
          const rect = ref.getBoundingClientRect()
          ref.setAttribute('rect-top', `${rect.y}`)
          ref.setAttribute('rect-left', `${rect.x}`)
        }
      }}
      onExit={shouldExit ? _handleExit : undefined}
      {...rest}
    >
      <svg
        className="w-full h-auto"
        viewBox="0 0 815 217"
        fill="none"
        preserveAspectRatio="xMaxYMid meet"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g clipPath="url(#clip0_17_219)">
          <path
            d="M708.153 217L815 144.382L754.045 28.1858L693.13 31.2199L708.153 217"
            fill="#C7352D"
          />
          <path
            d="M0.0145264 65.9012L113.033 -0.000348542L125.587 150.37L98.2794 150.655L0.0145264 65.9012"
            fill="#C7352D"
          />
          <path
            d="M1.2723 66.1687L98.6391 150.174L814.177 143.889L753.751 28.7009L1.2723 66.1687Z"
            fill="#FAFAFA"
            stroke="#FAFAFA"
          />
          <path
            d="M178.109 86.1803L178.434 94.598L163.215 95.1333L163.473 101.824L174.698 101.43L175.009 109.47L163.783 109.864L164.358 124.757L153.781 125.129L152.313 87.0876L178.109 86.1803ZM193.647 98.7638C194.768 96.9954 196.154 95.5778 197.806 94.511C199.458 93.4443 201.255 92.8768 203.198 92.8084L203.634 104.086L200.665 104.19C198.363 104.271 196.671 104.781 195.591 105.72C194.51 106.658 194.013 108.243 194.099 110.473L194.609 123.693L184.032 124.065L182.863 93.7938L193.441 93.4218L193.647 98.7638ZM222.269 123.099C219.247 123.205 216.506 122.671 214.047 121.497C211.624 120.321 209.684 118.588 208.226 116.298C206.769 114.008 205.979 111.28 205.857 108.114C205.736 104.985 206.314 102.227 207.591 99.8403C208.904 97.4527 210.723 95.5876 213.049 94.2451C215.411 92.9012 218.103 92.1762 221.125 92.0699C224.148 91.9636 226.87 92.4982 229.293 93.6737C231.752 94.848 233.711 96.5803 235.168 98.8704C236.661 101.159 237.469 103.869 237.589 106.998C237.71 110.128 237.115 112.905 235.803 115.328C234.526 117.715 232.707 119.58 230.345 120.923C227.983 122.267 225.291 122.992 222.269 123.099ZM221.915 113.925C223.39 113.874 224.592 113.291 225.522 112.178C226.486 111.027 226.929 109.426 226.85 107.376C226.771 105.326 226.207 103.778 225.158 102.735C224.145 101.69 222.919 101.192 221.479 101.243C220.04 101.294 218.856 101.876 217.926 102.989C216.996 104.102 216.571 105.684 216.65 107.735C216.731 109.821 217.26 111.388 218.237 112.434C219.214 113.48 220.44 113.977 221.915 113.925ZM261.105 90.7718C264.595 90.6491 267.41 91.7207 269.551 93.9869C271.691 96.217 272.837 99.3106 272.99 103.268L273.671 120.913L263.093 121.285L262.466 105.043C262.4 103.316 261.898 101.983 260.961 101.043C260.023 100.068 258.798 99.6063 257.287 99.6594C255.704 99.7151 254.482 100.262 253.621 101.301C252.76 102.304 252.362 103.669 252.429 105.396L253.055 121.638L242.478 122.01L241.31 91.7382L251.887 91.3662L252.054 95.683C252.936 94.2831 254.153 93.1416 255.704 92.2585C257.254 91.3395 259.054 90.8439 261.105 90.7718ZM296.99 111.069L297.338 120.08L292.75 120.241C285.015 120.514 281 116.818 280.704 109.156L280.319 99.1736L276.595 99.3045L276.255 90.5091L279.979 90.3781L279.696 83.0396L290.327 82.6657L290.611 90.0042L296.115 89.8106L296.455 98.606L290.95 98.7997L291.342 108.944C291.374 109.771 291.576 110.359 291.95 110.706C292.36 111.052 293.014 111.209 293.914 111.177L296.99 111.069ZM330.517 103.406C330.549 104.233 330.527 105.062 330.451 105.894L310.43 106.598C310.602 108.249 311.099 109.474 311.923 110.273C312.781 111.036 313.839 111.395 315.098 111.351C316.861 111.289 318.09 110.453 318.785 108.843L330.064 108.447C329.676 110.55 328.831 112.452 327.528 114.155C326.259 115.821 324.617 117.157 322.603 118.165C320.588 119.172 318.34 119.72 315.857 119.807C312.871 119.912 310.184 119.376 307.797 118.199C305.446 117.021 303.56 115.287 302.138 112.995C300.753 110.702 299.999 107.973 299.877 104.808C299.755 101.642 300.297 98.8852 301.503 96.5373C302.708 94.1535 304.438 92.2916 306.692 90.9515C308.981 89.6102 311.638 88.8864 314.66 88.7801C317.646 88.6751 320.314 89.1936 322.664 90.3357C325.013 91.4779 326.88 93.1773 328.264 95.434C329.647 97.6548 330.398 100.312 330.517 103.406ZM319.622 101.141C319.572 99.8462 319.101 98.8542 318.21 98.1651C317.318 97.44 316.224 97.1003 314.929 97.1458C313.633 97.1914 312.586 97.5884 311.786 98.337C310.985 99.0496 310.485 100.094 310.286 101.47L319.622 101.141ZM354.071 87.5021C357.561 87.3793 360.376 88.451 362.517 90.7171C364.657 92.9473 365.803 96.0409 365.956 99.998L366.637 117.643L356.059 118.015L355.432 101.773C355.366 100.046 354.864 98.713 353.927 97.7734C352.989 96.7978 351.764 96.3366 350.253 96.3897C348.67 96.4454 347.448 96.9927 346.587 98.0315C345.725 99.0345 345.328 100.399 345.394 102.126L346.021 118.368L335.444 118.74L334.276 88.4684L344.853 88.0964L345.02 92.4132C345.902 91.0133 347.119 89.8719 348.67 88.9888C350.22 88.0698 352.02 87.5742 354.071 87.5021ZM370.128 102.337C370.008 99.207 370.46 96.4535 371.485 94.076C372.546 91.6972 374.041 89.8435 375.972 88.5149C377.902 87.1862 380.072 86.4795 382.483 86.3947C384.425 86.3264 386.168 86.6793 387.711 87.4536C389.289 88.1906 390.537 89.2454 391.454 90.6179L390.921 76.8042L401.552 76.4303L403.094 116.361L392.462 116.734L392.3 112.526C391.526 113.958 390.4 115.114 388.921 115.995C387.442 116.875 385.677 117.351 383.626 117.424C381.216 117.508 378.997 116.956 376.969 115.766C374.978 114.576 373.362 112.831 372.12 110.534C370.913 108.199 370.249 105.466 370.128 102.337ZM391.931 101.57C391.856 99.6273 391.257 98.1175 390.135 97.0402C389.048 95.9618 387.732 95.4497 386.185 95.5042C384.602 95.5598 383.31 96.1636 382.31 97.3155C381.308 98.4314 380.845 99.9786 380.922 101.957C380.997 103.9 381.578 105.428 382.666 106.543C383.752 107.621 385.087 108.132 386.67 108.077C388.217 108.022 389.491 107.419 390.491 106.267C391.527 105.114 392.007 103.548 391.931 101.57ZM433.039 77.214C437.032 77.0736 440.554 77.7602 443.602 79.274C446.685 80.7505 449.092 82.8993 450.822 85.7202C452.552 88.5411 453.489 91.8042 453.632 95.5094C453.773 99.1787 453.072 102.481 451.528 105.417C450.02 108.352 447.787 110.7 444.829 112.461C441.905 114.185 438.465 115.117 434.507 115.256L419.451 115.785L417.982 77.7436L433.039 77.214ZM433.337 105.949C436.432 105.84 438.827 104.91 440.525 103.157C442.223 101.404 443.012 98.9808 442.892 95.8871C442.772 92.7575 441.797 90.3782 439.969 88.7495C438.139 87.0848 435.678 86.3069 432.584 86.4157L428.914 86.5448L429.668 106.078L433.337 105.949ZM487.463 97.8857C487.495 98.7131 487.473 99.5423 487.397 100.374L467.376 101.078C467.547 102.729 468.045 103.954 468.869 104.753C469.727 105.516 470.785 105.875 472.044 105.831C473.807 105.769 475.036 104.933 475.73 103.323L487.009 102.927C486.622 105.03 485.777 106.932 484.474 108.635C483.205 110.301 481.563 111.637 479.549 112.645C477.534 113.652 475.286 114.2 472.803 114.287C469.817 114.392 467.13 113.856 464.743 112.679C462.392 111.501 460.506 109.767 459.084 107.475C457.699 105.182 456.945 102.453 456.823 99.2876C456.701 96.1219 457.243 93.3652 458.449 91.0173C459.654 88.6335 461.383 86.7716 463.637 85.4315C465.927 84.0902 468.583 83.3664 471.606 83.2601C474.592 83.1551 477.26 83.6736 479.61 84.8157C481.959 85.9579 483.826 87.6573 485.21 89.914C486.593 92.1348 487.344 94.792 487.463 97.8857ZM476.568 95.6213C476.518 94.3262 476.047 93.3342 475.156 92.6451C474.264 91.92 473.17 91.5802 471.874 91.6258C470.579 91.6714 469.532 92.0684 468.732 92.817C467.931 93.5296 467.431 94.5738 467.232 95.9496L476.568 95.6213ZM506.522 102.727L511.405 82.2386L522.684 81.8419L513.437 112.48L500.269 112.943L488.685 83.0377L499.964 82.641L506.522 102.727ZM555.765 95.4834C555.797 96.3108 555.775 97.1401 555.699 97.9713L535.677 98.6755C535.849 100.326 536.347 101.552 537.17 102.351C538.028 103.114 539.087 103.473 540.346 103.428C542.109 103.366 543.338 102.531 544.032 100.921L555.311 100.524C554.924 102.627 554.079 104.53 552.775 106.233C551.507 107.899 549.865 109.235 547.85 110.243C545.836 111.25 543.587 111.797 541.105 111.885C538.118 111.99 535.432 111.454 533.045 110.277C530.694 109.099 528.807 107.364 527.386 105.073C526 102.78 525.247 100.051 525.124 96.8853C525.002 93.7197 525.544 90.9629 526.751 88.6151C527.956 86.2313 529.685 84.3693 531.939 83.0293C534.229 81.688 536.885 80.9642 539.907 80.8579C542.893 80.7528 545.561 81.2714 547.911 82.4135C550.261 83.5556 552.128 85.255 553.512 87.5117C554.894 89.7325 555.645 92.3897 555.765 95.4834ZM544.87 93.219C544.82 91.924 544.349 90.9319 543.458 90.2428C542.565 89.5177 541.471 89.178 540.176 89.2235C538.881 89.2691 537.833 89.6662 537.034 90.4147C536.232 91.1273 535.732 92.1715 535.533 93.5474L544.87 93.219ZM569.728 70.5154L571.269 110.446L560.691 110.818L559.15 70.8874L569.728 70.5154ZM591.392 110.116C588.37 110.222 585.63 109.688 583.17 108.514C580.747 107.339 578.807 105.606 577.35 103.316C575.892 101.025 575.102 98.2974 574.98 95.1318C574.859 92.0021 575.438 89.2441 576.714 86.8578C578.027 84.4702 579.847 82.6051 582.173 81.2625C584.535 79.9186 587.227 79.1936 590.249 79.0873C593.271 78.981 595.993 79.5156 598.417 80.6912C600.876 81.8655 602.834 83.5977 604.291 85.8879C605.785 88.1768 606.592 90.8861 606.713 94.0157C606.833 97.1454 606.238 99.922 604.927 102.346C603.65 104.732 601.83 106.597 599.468 107.941C597.106 109.285 594.414 110.01 591.392 110.116ZM591.038 100.943C592.513 100.891 593.716 100.308 594.645 99.1951C595.61 98.0445 596.052 96.4439 595.973 94.3934C595.894 92.343 595.33 90.7958 594.281 89.7521C593.268 88.707 592.042 88.2098 590.603 88.2605C589.164 88.3111 587.979 88.8931 587.049 90.0064C586.12 91.1198 585.694 92.7017 585.774 94.7522C585.854 96.8386 586.383 98.405 587.36 99.4513C588.337 100.498 589.563 100.995 591.038 100.943ZM621.173 82.5925C621.946 81.1604 623.072 80.0041 624.552 79.1236C626.031 78.243 627.796 77.7667 629.846 77.6946C632.257 77.6098 634.458 78.1628 636.449 79.3535C638.477 80.543 640.093 82.2872 641.299 84.5863C642.54 86.884 643.221 89.5977 643.342 92.7274C643.463 95.8571 642.993 98.6293 641.934 101.044C640.909 103.421 639.431 105.275 637.501 106.603C635.607 107.931 633.454 108.637 631.044 108.721C628.993 108.794 627.196 108.443 625.653 107.668C624.146 106.893 622.934 105.819 622.016 104.446L622.737 123.116L612.159 123.488L610.433 78.7556L621.01 78.3836L621.173 82.5925ZM632.603 93.1051C632.526 91.1266 631.928 89.6167 630.807 88.5755C629.72 87.497 628.404 86.985 626.857 87.0394C625.309 87.0938 624.018 87.6976 622.982 88.8507C621.981 90.0026 621.519 91.5498 621.594 93.4923C621.67 95.4709 622.251 96.9994 623.338 98.0778C624.46 99.155 625.795 99.6664 627.342 99.612C628.889 99.5576 630.162 98.9545 631.163 97.8026C632.198 96.6135 632.678 95.0477 632.603 93.1051ZM676.61 91.2331C676.642 92.0605 676.62 92.8898 676.544 93.721L656.522 94.4252C656.694 96.0761 657.192 97.3014 658.015 98.1009C658.873 98.8633 659.932 99.2223 661.191 99.178C662.954 99.116 664.183 98.2803 664.877 96.6709L676.156 96.2742C675.769 98.3771 674.924 100.28 673.62 101.983C672.352 103.648 670.71 104.985 668.695 105.992C666.681 107 664.432 107.547 661.95 107.634C658.964 107.74 656.277 107.204 653.89 106.027C651.539 104.849 649.652 103.114 648.231 100.823C646.846 98.5298 646.092 95.8006 645.97 92.635C645.847 89.4694 646.389 86.7126 647.596 84.3648C648.801 81.981 650.53 80.119 652.784 78.779C655.074 77.4377 657.73 76.7139 660.752 76.6076C663.738 76.5026 666.406 77.0211 668.756 78.1632C671.106 79.3053 672.973 81.0047 674.357 83.2615C675.74 85.4822 676.491 88.1394 676.61 91.2331ZM665.715 88.9687C665.665 87.6737 665.194 86.6816 664.303 85.9925C663.41 85.2675 662.316 84.9277 661.021 84.9733C659.726 85.0188 658.678 85.4159 657.879 86.1644C657.078 86.877 656.578 87.9212 656.378 89.2971L665.715 88.9687ZM691.152 81.2659C692.272 79.4974 693.659 78.0798 695.311 77.0131C696.963 75.9464 698.76 75.3788 700.703 75.3105L701.138 86.5881L698.17 86.6925C695.868 86.7735 694.176 87.2833 693.095 88.2218C692.015 89.1604 691.518 90.7448 691.604 92.9752L692.114 106.195L681.537 106.567L680.368 76.2959L690.946 75.9239L691.152 81.2659Z"
            fill="black"
          />
        </g>
        <defs>
          <clipPath id="clip0_17_219">
            <rect width="815" height="217" fill="white" />
          </clipPath>
        </defs>
      </svg>
    </LogoBase>
  )
}

export default Ribbon
